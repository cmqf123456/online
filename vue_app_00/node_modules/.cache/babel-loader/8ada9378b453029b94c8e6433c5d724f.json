{"remainingRequest":"d:\\xampp\\htdocs\\tml1903\\online\\vue_app_00\\node_modules\\babel-loader\\lib\\index.js!d:\\xampp\\htdocs\\tml1903\\online\\vue_app_00\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!d:\\xampp\\htdocs\\tml1903\\online\\vue_app_00\\src\\components\\booking\\common\\BookCart.vue?vue&type=script&lang=js","dependencies":[{"path":"d:\\xampp\\htdocs\\tml1903\\online\\vue_app_00\\src\\components\\booking\\common\\BookCart.vue","mtime":1564058815175},{"path":"d:\\xampp\\htdocs\\tml1903\\online\\vue_app_00\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1562979686325},{"path":"d:\\xampp\\htdocs\\tml1903\\online\\vue_app_00\\node_modules\\babel-loader\\lib\\index.js","mtime":1562979686216},{"path":"d:\\xampp\\htdocs\\tml1903\\online\\vue_app_00\\node_modules\\vue-loader\\lib\\index.js","mtime":1562979690388}],"contextDependencies":[],"result":["import \"core-js/modules/es7.symbol.async-iterator\";\nimport \"core-js/modules/es6.symbol\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport TitleBar from \"./TitleBar.vue\";\nimport Bottom from \"./Bottom.vue\";\nexport default {\n  data: function data() {\n    return {\n      gdate: \"\",\n      // 购物车\n      cart: []\n    };\n  },\n  //data结束\n  components: {\n    \"titlebar\": TitleBar,\n    \"bottombar\": Bottom\n  },\n  created: function created() {\n    // 页面运行到订单第三个页面\n    sessionStorage.setItem(\"pageNo3\", 3);\n    this.gdate = sessionStorage.getItem(\"gdate\"); // 获取购物车字符串\n\n    var str = sessionStorage.getItem(\"cart\"); // 将字符串转为数组\n\n    var cart = JSON.parse(str); // console.log(cart);\n    // 将购物车数组放入data数据中\n\n    this.cart = cart;\n    console.log(this.cart);\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n      for (var _iterator = cart[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n        var elem = _step.value;\n      }\n    } catch (err) {\n      _didIteratorError = true;\n      _iteratorError = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion && _iterator.return != null) {\n          _iterator.return();\n        }\n      } finally {\n        if (_didIteratorError) {\n          throw _iteratorError;\n        }\n      }\n    }\n  },\n  methods: {\n    next: function next() {\n      var _this = this;\n\n      // 调出确认框\n      this.$messagebox.confirm(\"确认支付？\").then(function (active) {\n        // 1. 点击确认后\n        var _iteratorNormalCompletion2 = true;\n        var _didIteratorError2 = false;\n        var _iteratorError2 = undefined;\n\n        try {\n          for (var _iterator2 = _this.cart[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n            var elem = _step2.value;\n            // 修改状态码\n            var obj = elem[0];\n            obj.bstatus = 1; // console.log(obj);\n            // 再插入数据库\n\n            _this.axios.get(\"cart\", {\n              params: obj\n            }).then(function (result) {\n              console.log(result);\n\n              _this.$toast(\"成功支付 ¥\" + _this.total.toFixed(2));\n\n              _this.$router.push(\"/Orderlist\");\n            });\n          }\n        } catch (err) {\n          _didIteratorError2 = true;\n          _iteratorError2 = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n              _iterator2.return();\n            }\n          } finally {\n            if (_didIteratorError2) {\n              throw _iteratorError2;\n            }\n          }\n        }\n      }).catch(function (err) {\n        // 2. 点击取消后\n        if (err == \"cancel\") {\n          // console.log(333);\n          // 插入数据库\n          var _iteratorNormalCompletion3 = true;\n          var _didIteratorError3 = false;\n          var _iteratorError3 = undefined;\n\n          try {\n            for (var _iterator3 = _this.cart[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n              var elem = _step3.value;\n              var obj = elem[0];\n\n              _this.axios.get(\"cart\", {\n                params: obj\n              }).then(function (result) {\n                console.log(result);\n\n                _this.$toast(\"订单待支付\");\n\n                _this.$router.push(\"/Orderlist\");\n              });\n            }\n          } catch (err) {\n            _didIteratorError3 = true;\n            _iteratorError3 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n                _iterator3.return();\n              }\n            } finally {\n              if (_didIteratorError3) {\n                throw _iteratorError3;\n              }\n            }\n          }\n        }\n      });\n    },\n    jumpLeft: function jumpLeft() {\n      console.log(22); // sessionStorage.getItem(\"jumpLeft\",\"/BookTics\");\n    }\n  },\n  // 计算属性\n  computed: {\n    // 计算总价格\n    total: function total() {\n      var sum = 0;\n      var _iteratorNormalCompletion4 = true;\n      var _didIteratorError4 = false;\n      var _iteratorError4 = undefined;\n\n      try {\n        for (var _iterator4 = this.cart[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n          var elem = _step4.value;\n          sum += elem.length * elem[0].bprice;\n        }\n      } catch (err) {\n        _didIteratorError4 = true;\n        _iteratorError4 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion4 && _iterator4.return != null) {\n            _iterator4.return();\n          }\n        } finally {\n          if (_didIteratorError4) {\n            throw _iteratorError4;\n          }\n        }\n      }\n\n      return sum;\n    },\n    // 计算总票数\n    totalTics: function totalTics() {\n      var sum = 0;\n      var _iteratorNormalCompletion5 = true;\n      var _didIteratorError5 = false;\n      var _iteratorError5 = undefined;\n\n      try {\n        for (var _iterator5 = this.cart[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n          var elem = _step5.value;\n          sum += elem.length;\n        }\n      } catch (err) {\n        _didIteratorError5 = true;\n        _iteratorError5 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion5 && _iterator5.return != null) {\n            _iterator5.return();\n          }\n        } finally {\n          if (_didIteratorError5) {\n            throw _iteratorError5;\n          }\n        }\n      }\n\n      return sum;\n    }\n  }\n};",{"version":3,"sources":["BookCart.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <titlebar leftTitle=\"在线购票\"></titlebar>\r\n    <!--防止顶部溢出\r\n    <div style=\"height:40px;\"></div>-->\r\n    <div class=\"content\">\r\n      <!--头部-->\r\n      <div class=\"cartTop\">\r\n        <p>订单结算</p>\r\n      </div>\r\n      <!--购票日期-->\r\n      <div class=\"cartDate\">购票日期：<span>{{gdate}}</span></div>\r\n      <!--购物车主体-->\r\n      <div class=\"cart\">\r\n        <ul>\r\n          <li>门票类型</li>\r\n          <li>数量</li>\r\n          <li>单价</li>\r\n          <li>小计</li>\r\n        </ul>\r\n        <ul v-for=\"(elem,i) of cart\" :key=\"i\">\r\n          <!--获取票种-->\r\n          <li>{{elem[0].book}}</li>\r\n          <!--获取每个票种对应的张数-->\r\n          <li>{{elem.length}}</li>\r\n          <!--获取每个票种对应的单价-->\r\n          <li>¥{{elem[0].bprice.toFixed(2)}}</li>\r\n          <!--通过获取每个票种对应的小计-->\r\n          <li>¥{{(elem.length*elem[0].bprice).toFixed(2)}}</li>\r\n        </ul>\r\n        <ul>\r\n          <li>合计</li>\r\n          <li>{{totalTics}}</li>\r\n          <li></li>\r\n          <li>¥{{total.toFixed(2)}}</li>\r\n        </ul>\r\n        <!-- <p>手机号：<span>{{phone}}</span></p> -->\r\n      </div>\r\n      <!--提示信息\r\n      <div class=\"cartMsg\">\r\n        <p>\r\n          温馨提示：订单提交成功，请您务必在15分钟内完成支付，否则您的订单将自动取消！\r\n        </p>\r\n      </div>-->\r\n      <!--结算按钮和信息-->\r\n      <div class=\"cartBtm\">\r\n        <!--计算属性算出总和total-->\r\n        <p>合计：¥<span>{{total.toFixed(2)}}</span></p>\r\n        <p><span @click=\"next\">立即支付</span></p>\r\n      </div>\r\n    </div>\r\n    <!--底部箭头栏-->\r\n    <bottombar left=\"/BookTics\"></bottombar>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import TitleBar from \"./TitleBar.vue\";\r\n  import Bottom from \"./Bottom.vue\";\r\n\r\n  export default {\r\n    data(){\r\n      return {\r\n        gdate:\"\",\r\n        // 购物车\r\n        cart:[],\r\n      }\r\n    },//data结束\r\n    components:{\r\n      \"titlebar\":TitleBar,\r\n      \"bottombar\":Bottom,\r\n    },\r\n    created(){\r\n      // 页面运行到订单第三个页面\r\n      sessionStorage.setItem(\"pageNo3\",3);\r\n      this.gdate=sessionStorage.getItem(\"gdate\");\r\n      // 获取购物车字符串\r\n      var str=sessionStorage.getItem(\"cart\");\r\n      // 将字符串转为数组\r\n      var cart=JSON.parse(str);\r\n      // console.log(cart);\r\n      // 将购物车数组放入data数据中\r\n      this.cart=cart;\r\n      console.log(this.cart);\r\n      for(var elem of cart){\r\n\r\n      }\r\n    },\r\n    methods:{\r\n      next(){\r\n        // 调出确认框\r\n        this.$messagebox.confirm(\"确认支付？\")\r\n        .then(active=>{\r\n          // 1. 点击确认后\r\n          for(var elem of this.cart){\r\n            // 修改状态码\r\n            var obj=elem[0];\r\n            obj.bstatus=1;\r\n            // console.log(obj);\r\n            // 再插入数据库\r\n            this.axios.get(\"cart\",{params:obj})\r\n            .then(result=>{\r\n              console.log(result);\r\n              this.$toast(\"成功支付 ¥\"+this.total.toFixed(2));\r\n              this.$router.push(\"/Orderlist\");\r\n            });\r\n          }\r\n        }).catch(err=>{\r\n          // 2. 点击取消后\r\n          if(err==\"cancel\"){\r\n            // console.log(333);\r\n            // 插入数据库\r\n            for(var elem of this.cart){\r\n              var obj=elem[0];\r\n              this.axios.get(\"cart\",{params:obj})\r\n              .then(result=>{\r\n                console.log(result);\r\n                this.$toast(\"订单待支付\");\r\n                this.$router.push(\"/Orderlist\");\r\n              });\r\n            }\r\n            \r\n          }\r\n        })\r\n      },\r\n      jumpLeft(){\r\n        console.log(22);\r\n        // sessionStorage.getItem(\"jumpLeft\",\"/BookTics\");\r\n      }\r\n    },\r\n    // 计算属性\r\n    computed: {\r\n      // 计算总价格\r\n      total(){\r\n        var sum=0;\r\n        for(var elem of this.cart){\r\n          sum+=elem.length*elem[0].bprice;\r\n        }\r\n        return sum;\r\n      },\r\n      // 计算总票数\r\n      totalTics(){\r\n        var sum=0;\r\n        for(var elem of this.cart){\r\n          sum+=elem.length;\r\n        }\r\n        return sum;\r\n      },\r\n    },\r\n\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n  .container{\r\n    background-color:#f2f2f2;\r\n    color:#333;\r\n    font-size:14px;\r\n  }\r\n  .container:before{\r\n    content:\"\";\r\n    display:table;\r\n  }\r\n  .content{\r\n    padding:50px 0px;\r\n  }\r\n  /* 购物车头部样式 */\r\n  .cartTop{\r\n    display:flex;\r\n    justify-content:space-between;\r\n    background-color:#26a2ff;\r\n    color:#fff;\r\n    padding:0 20px;\r\n  }\r\n  .cartTop p{\r\n    margin:0;\r\n    height:40px;\r\n    line-height:40px;\r\n  }\r\n  .cartTop p:first-child{\r\n    font-size:16px;\r\n  }\r\n  .cartDate{\r\n    padding:10px 20px;\r\n    background-color:#fff;\r\n    font-size:16px;\r\n  }\r\n  /* 购物车样式 */\r\n  .cart{\r\n    margin:5px 0;\r\n    background-color:#fff;\r\n    padding:0 20px;\r\n  }\r\n  .cart ul{\r\n    display:flex;\r\n    margin:0;\r\n    padding:0;\r\n    list-style-type:none;\r\n    justify-content:space-between;\r\n    border-bottom:1px solid #eee;\r\n    height:40px;\r\n    line-height:40px;\r\n  }\r\n  .cart>ul:first-child{\r\n    color:#aaa;\r\n    border:none;\r\n  }\r\n  .cart ul li{\r\n    width:50px;\r\n    text-align:center;\r\n  }\r\n  .cart ul li:first-child{\r\n    width:100px;\r\n    text-align:left;\r\n  }\r\n  .cart ul li:last-child{\r\n    text-align:right;\r\n  }\r\n  .cart::after{\r\n    content:\"\";\r\n    display:table;\r\n  }\r\n  .cart p{\r\n    font-size:16px;\r\n  }\r\n  .cart p span{\r\n    color:#aaa;\r\n  }\r\n  /* 提示信息样式 */\r\n  .cartMsg p{\r\n    padding:0 20px;\r\n    font-size:12px;\r\n  }\r\n  /* 结算按钮和信息 */\r\n  .cartBtm{\r\n    position:fixed;\r\n    bottom:37px;\r\n    width:100%;\r\n    display:flex;\r\n    text-align:center;\r\n  }\r\n  .cartBtm p{\r\n    height:50px;\r\n    line-height:50px;\r\n    font-size:20px;\r\n    margin:0;\r\n  }\r\n  .cartBtm p:first-child{\r\n    width:50%;\r\n    color:#e6a062;\r\n    background:#fff;\r\n  }\r\n  .cartBtm p+p{\r\n    background-color:#e6a062;\r\n    width:50%;\r\n    color:#fff;\r\n  }\r\n</style>"],"sourceRoot":"src\\components\\booking\\common"}]}